!function(){function t(t){var o=this;l||(l=new i);var r=l.findGroup(this);r||(r=new s(l.boxDOM,n(this)),l.addGroup(r)),r.addSource(this);var a=new e(r.dom,t);a.timeline.start(),r.addSourceBox(a);var c=Rx.Observable.create(function(t){return o.subscribe(function(i){try{a.timeline.push(i),t.next(i)}catch(i){a.timeline.stop(),a.timeline.error(),t.error(i)}},function(i){a.timeline.stop(),a.timeline.error(),t.error(i)},function(){a.timeline.stop(),a.timeline.complete(),t.complete()})});return c.source=this,c}function i(){this.boxDOM=null,this.tooltipDOM=null,this.groups=[],this.init=function(){this.boxDOM||(this.boxDOM=r("div",document.body,{class:"rxjs-box"})),this.tooltipDOM||(this.tooltipDOM=r("pre",document.body,{class:"rxjs-tooltip"}))},this.stop=function(){for(var t=0;t<this.groups.length;t++)this.groups[t].stop()},this.findGroup=function(t){return this.groups.find(function(i){return i.rootObservable===n(t)})},this.addGroup=function(t){return this.groups.push(t),this.group},this.init()}function s(t,i){this.dom=null,this.rootObservable=i,this.sources=[],this.sourceBoxes=[],this.init=function(){this.dom=r("div",t,{class:"rxjs-group"})},this.stop=function(){for(var t=0;t<this.sourceBoxes.length;t++)this.sourceBoxes[t].timeline.stop()},this.addSource=function(t){this.sources.push(t),this.drawOperatorBoxes(t)},this.addSourceBox=function(t){this.sourceBoxes.push(t)},this.drawOperatorBoxes=function(t){for(var i=t,s=r("div",this.dom,{class:"rxjs-operators"});i!==this.sources[this.sources.length-2];)i.operator&&r("div",s,{class:"rxjs-operator",innerHTML:i.operator.constructor.name}),i=i.source},this.init()}function e(t,i){this.dom=null,this.name=i,this.timeline=null,this.init=function(){this.dom=r("div",t,{id:this.name,class:"rxjs-source"}),r("div",this.dom,{class:"rxjs-name",innerHTML:this.name}),this.timeline=new o(this.dom)},this.init()}function o(t){var i=this;this.dom=null,this.bar={dom:null,width:0},this.startTime=0,this.marbles=[],this.timerSubject=null,this.timerSubscription=null,this.scrollSubject=null,this.syncScrollSubscription=null,this.autoScrollSubscription=null,this.init=function(){this.dom=r("div",t,{class:"rxjs-timeline-container"}),this.bar.dom=r("div",this.dom,{class:"rxjs-timeline"}),this.startTime=Date.now(),this.timerSubject=Rx.Observable.of(0,Rx.Scheduler.animationFrame).repeat().map(function(){return Date.now()}).share(),this.scrollSubject=Rx.Observable.fromEvent(this.dom,"scroll").share(),Rx.Observable.fromEvent(this.dom,"mousemove").subscribe(function(t){var s=t.target;if(s.matches(".rxjs-marble")){var e=Array.prototype.indexOf.call(s.parentNode.childNodes,s),o=i.marbles[e],n=o.value;if("object"==typeof o.value&&o.value&&"Object"===o.value.constructor.name)try{n=JSON.stringify(n,null,2)}catch(t){n=o.value}l.tooltipDOM.innerHTML=n,r("div",l.tooltipDOM,{innerHTML:"Type: "+typeof o.value}),r("div",l.tooltipDOM,{innerHTML:"Time: "+(o.time-i.startTime)+"ms"}),l.tooltipDOM.style.left=t.clientX+"px",l.tooltipDOM.style.top=t.clientY+"px",l.tooltipDOM.style.display="inline-block"}else l.tooltipDOM.style.display="none"}),Rx.Observable.fromEvent(this.dom,"mouseleave").subscribe(function(){l.tooltipDOM.style.display="none"}),this.syncScrollSubsciption=this.scrollSubject.subscribe(function(t){for(var s=i.dom.parentNode.parentNode.querySelectorAll(".rxjs-timeline-container"),e=0;e<s.length;e++)s[e].scrollLeft=i.dom.scrollLeft})},this.start=function(){this.timerSubscription=this.timerSubject.subscribe(function(t){i.bar.width=100*(t-i.startTime)/1e3,i.bar.dom.style.width=i.bar.width+"px"});var t=this.scrollSubject.throttleTime(100).pluck("target","scrollLeft").pairwise().filter(function(t){return t[0]>t[1]});this.autoScrollSubscription=this.timerSubject.takeUntil(t).subscribe(function(t){i.dom.scrollLeft=i.dom.scrollWidth})},this.stop=function(){this.timerSubscription.unsubscribe(),this.autoScrollSubscription.unsubscribe()},this.push=function(t){var i=t;"number"==typeof t?(i=t.toString()).length>4&&(i="[N]"):"string"==typeof t?t.length>4&&(i="[S]"):"boolean"==typeof t?i=t.toString():"function"==typeof t?i="[F]":"object"==typeof t?i=null===t?"null":"[O]":void 0===t&&(i="[U]");var s=this.marbles.length?this.marbles[this.marbles.length-1]:null,e=0,o=this.bar.width;s&&s.left===o&&(e=s.top+5);var n={time:(new Date).getTime(),value:t,display:i,top:e,left:o};this.marbles.push(n);var l=r("div",this.bar.dom,{class:"rxjs-marble",innerHTML:i});l.style.top=n.top+"px",l.style.left=n.left+"px"},this.error=function(){this.bar.dom.classList.add("rxjs-timeline-error")},this.complete=function(){this.bar.dom.classList.add("rxjs-timeline-complete")},this.init()}function r(t,i,s){var e=document.createElement(t);if(s.id&&(e.id=s.id),s.class&&("string"==typeof s.class?e.classList.add(s.class):e.classList.add.apply(e.classList,s.class)),s.innerHTML&&(e.innerHTML=s.innerHTML),s.dataset)for(var o in s.dataset)e.dataset[o]=s.dataset[o];return i.appendChild(e),e}function n(t){for(var i=t;i.source;)i=i.source;return i}var l=new i;Rx.Observable.prototype.draw=t,i.prototype.createAndAppend=r,i.prototype.findRootObservable=n,window.rxjsDraw=l}();
//# sourceMappingURL=rxjs-draw.min.js.map
